
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fontai.prediction package &#8212; textfont-ai 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="fontai-prediction-package">
<h1>fontai.prediction package<a class="headerlink" href="#fontai-prediction-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-fontai.prediction.callbacks">
<span id="fontai-prediction-callbacks-module"></span><h2>fontai.prediction.callbacks module<a class="headerlink" href="#module-fontai.prediction.callbacks" title="Permalink to this headline">¶</a></h2>
<p>This module contains custom Tensorflow callbacks</p>
<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAEFontSamplerCallback">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SAAEFontSamplerCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAEFontSamplerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#fontai.prediction.callbacks.SAAEImageSamplerCallback" title="fontai.prediction.callbacks.SAAEImageSamplerCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">fontai.prediction.callbacks.SAAEImageSamplerCallback</span></code></a></p>
<p>Generates a random font style from the model, generates all of its characters and pushes them to MLFLow at the end of each epoch</p>
<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAEFontSamplerCallback.generate_images">
<span class="sig-name descname"><span class="pre">generate_images</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAEFontSamplerCallback.generate_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAEImageSamplerCallback">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SAAEImageSamplerCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_imgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAEImageSamplerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.callbacks.Callback</span></code></p>
<p>Generates randomly chosen character images from the model at the end of each epoch and pushes them to MLFLow.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAEImageSamplerCallback.generate_images">
<span class="sig-name descname"><span class="pre">generate_images</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAEImageSamplerCallback.generate_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAEImageSamplerCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_logs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAEImageSamplerCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only
be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> – integer, index of epoch.</p></li>
<li><p><strong>logs</strong> – dict, metric results for this training epoch, and for the
validation epoch if validation is performed. Validation result keys
are prefixed with <cite>val_</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAEImageSamplerCallback.plot_images">
<span class="sig-name descname"><span class="pre">plot_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">tensorflow.python.framework.ops.Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">None</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAEImageSamplerCallback.plot_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to plot a sequence of characters and save it in a given location as a single tiled figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>t.Union</em><em>[</em><em>tf.Tensor</em><em>, </em><em>np.ndarray</em><em>]</em>) – 4-dimensional array of images</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – output file</p></li>
<li><p><strong>n_cols</strong> (<em>int</em><em>, </em><em>optional</em>) – number of columns in output figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAELRHalver">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">SAAELRHalver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">halve_after</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAELRHalver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.callbacks.Callback</span></code></p>
<p>Halves the step size of every embedded model in a custom supervised adversarial autoencoder as defined in the <cite>models</cite> submodule, up to a minimum accepted step size</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAELRHalver.halve_after">
<span class="sig-name descname"><span class="pre">halve_after</span></span><a class="headerlink" href="#fontai.prediction.callbacks.SAAELRHalver.halve_after" title="Permalink to this definition">¶</a></dt>
<dd><p>number of epochs after which step sizes are halved</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAELRHalver.min_lr">
<span class="sig-name descname"><span class="pre">min_lr</span></span><a class="headerlink" href="#fontai.prediction.callbacks.SAAELRHalver.min_lr" title="Permalink to this definition">¶</a></dt>
<dd><p>lower bound for step size</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.callbacks.SAAELRHalver.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.callbacks.SAAELRHalver.on_epoch_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only
be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> – integer, index of epoch.</p></li>
<li><p><strong>logs</strong> – dict. Currently no data is passed to this argument for this method
but that may change in the future.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fontai.prediction.custom_filters">
<span id="fontai-prediction-custom-filters-module"></span><h2>fontai.prediction.custom_filters module<a class="headerlink" href="#module-fontai.prediction.custom_filters" title="Permalink to this headline">¶</a></h2>
<p>This module contains filtering functions for Tensorflow dataset operations that are applied to model inputs right after being deserialised to be used at training time</p>
<dl class="py function">
<dt class="sig sig-object py" id="fontai.prediction.custom_filters.filter_chars_by_score">
<span class="sig-name descname"><span class="pre">filter_chars_by_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.custom_filters.filter_chars_by_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Filtering function for Tensorflow datasets that filter out scores lower than a given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Filtering function for Tensorflow datasets</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>t.Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fontai.prediction.custom_filters.filter_fonts_by_size">
<span class="sig-name descname"><span class="pre">filter_fonts_by_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_chars</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.custom_filters.filter_fonts_by_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Filtering function for Tensorflow datasets that filter out fonts with too few remaining characters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Filtering function for Tensorflow datasets</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>t.Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fontai.prediction.custom_filters.filter_misclassified_chars">
<span class="sig-name descname"><span class="pre">filter_misclassified_chars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.custom_filters.filter_misclassified_chars" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a filtering function for Tensorflow datasets that filter out misclassified examples; examples must have the schema as in ScoredLabeledChars._tfr_schema</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Filtering function for Tensorflow datasets</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>t.Callable</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-fontai.prediction.custom_mappers">
<span id="fontai-prediction-custom-mappers-module"></span><h2>fontai.prediction.custom_mappers module<a class="headerlink" href="#module-fontai.prediction.custom_mappers" title="Permalink to this headline">¶</a></h2>
<p>This module contains mapper functions to be applied to Tensorflow examples right after being deserialised to be used at training time; at the moment available functions filter examples based on the score’s accuracy and values, and do so for scored font records.</p>
<dl class="py function">
<dt class="sig sig-object py" id="fontai.prediction.custom_mappers.drop_misclassified_in_font">
<span class="sig-name descname"><span class="pre">drop_misclassified_in_font</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.custom_mappers.drop_misclassified_in_font" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a mapper function for Tensorflow datasets that drops misclassified images in a font batch; examples must have the schema as in ScoredLabeledChars._tfr_schema</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mapping function for Tensorflow datasets</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>t.Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fontai.prediction.custom_mappers.keep_high_scores_in_font">
<span class="sig-name descname"><span class="pre">keep_high_scores_in_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.custom_mappers.keep_high_scores_in_font" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a function for Tensorflow datasets that drops images with low classification score in a font batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>threshold</strong> (<em>float</em>) – Score threshold</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mapping function fot Tensorflow datasets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>t.Callable</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-fontai.prediction.input_processing">
<span id="fontai-prediction-input-processing-module"></span><h2>fontai.prediction.input_processing module<a class="headerlink" href="#module-fontai.prediction.input_processing" title="Permalink to this headline">¶</a></h2>
<p>This module contains input preprocessing logic that happends right before data is ingested by the model to be trained.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">RecordPreprocessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_record_class</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charset_tensor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow.python.framework.ops.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_filters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_mappers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Fetches and processes a list of Tensorflow record files to be consumed by an ML model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.charset">
<span class="sig-name descname"><span class="pre">charset</span></span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.charset" title="Permalink to this definition">¶</a></dt>
<dd><p>string with every character that needs to be extracted</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>char</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.charset_tensor">
<span class="sig-name descname"><span class="pre">charset_tensor</span></span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.charset_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>charset in tensor form</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.custom_filters">
<span class="sig-name descname"><span class="pre">custom_filters</span></span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.custom_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>List of custom_filters to apply to training data</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>t.List[types.Callable]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.num_classes">
<span class="sig-name descname"><span class="pre">num_classes</span></span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.num_classes" title="Permalink to this definition">¶</a></dt>
<dd><p>number of classes in charset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.add_batch_shape_signature">
<span class="sig-name descname"><span class="pre">add_batch_shape_signature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow.python.data.ops.readers.TFRecordDatasetV2</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">tensorflow.python.data.ops.readers.TFRecordDatasetV2</span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.add_batch_shape_signature" title="Permalink to this definition">¶</a></dt>
<dd><p>Intermediate method required to make training data shapes known at graph compile time. Returns the passed data wrapped in a callable object with explicit output shape signatures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>TFRecordDataset</em>) – Input training data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TFRecordDataset</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.fetch">
<span class="sig-name descname"><span class="pre">fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow.python.data.ops.readers.TFRecordDatasetV2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches a list of input Tensorflow record files and prepares them for training or scoring</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>TFRecordDataset</em>) – input data</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – training batch size</p></li>
<li><p><strong>training_format</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, returns features and a one hot encoded label; otherwise, returns a dict of parsed bytestreams with labels as bytes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset ready for model consumption</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TFRecordDataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.label_is_nonempty">
<span class="sig-name descname"><span class="pre">label_is_nonempty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.label_is_nonempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters out training examples without rows or correctly formatted labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>tf.Tensor</em>) – </p></li>
<li><p><strong>labels</strong> (<em>tf.Tensor</em>) – </p></li>
<li><p><strong>args</strong> – other arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.scramble">
<span class="sig-name descname"><span class="pre">scramble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffered_batches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.scramble" title="Permalink to this definition">¶</a></dt>
<dd><p>Scrambles a data set randomly and makes it unbounded in order to process an arbitrary number of batches</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>TFRecordDataset</em>) – Input dataset</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – training batch size</p></li>
<li><p><strong>buffered_batches</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of batches to fetch in memory buffer</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>TFRecordDataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.input_processing.RecordPreprocessor.split_parsed_dict">
<span class="sig-name descname"><span class="pre">split_parsed_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsed_dict</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.input_processing.RecordPreprocessor.split_parsed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a parsed record dictionary into features, labels and fontname</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parsed_dict</strong> (<em>t.Dict</em>) – parsed record dictionary</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>t.Tuple[tf.Tensor, tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fontai.prediction.models">
<span id="fontai-prediction-models-module"></span><h2>fontai.prediction.models module<a class="headerlink" href="#module-fontai.prediction.models" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">CharStyleSAAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.engine.training.Model</span></code></p>
<p>This class fits a supervised adversarial autoencoder as laid out in “Adversarial Autoencoders” by Ian Goodfellow et al.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.accuracy_metric">
<span class="sig-name descname"><span class="pre">accuracy_metric</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.accuracy_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Accuracy metric</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.metrics.Accuracy</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.cross_entropy">
<span class="sig-name descname"><span class="pre">cross_entropy</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross entropy loss</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.losses.BinaryCrossentropy</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.decoder">
<span class="sig-name descname"><span class="pre">decoder</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Decoder model</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.prior_discriminator">
<span class="sig-name descname"><span class="pre">prior_discriminator</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.prior_discriminator" title="Permalink to this definition">¶</a></dt>
<dd><p>prior_discriminator model</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.full_encoder">
<span class="sig-name descname"><span class="pre">full_encoder</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.full_encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder that takes high-level image features and labels</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.image_encoder">
<span class="sig-name descname"><span class="pre">image_encoder</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.image_encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Encoder for image features</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.input_dim">
<span class="sig-name descname"><span class="pre">input_dim</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.input_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Input dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>t.Tuple[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.mse_loss">
<span class="sig-name descname"><span class="pre">mse_loss</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.mse_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Description</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.mse_metric">
<span class="sig-name descname"><span class="pre">mse_metric</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.mse_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>MSE loss</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tf.keras.losses.MSE</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.prior_batch_size">
<span class="sig-name descname"><span class="pre">prior_batch_size</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.prior_batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch size from prior distribution at training time</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.rec_loss_weight">
<span class="sig-name descname"><span class="pre">rec_loss_weight</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.rec_loss_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight of reconstruction loss at training time. Should be between 0 and 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rmsprop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_eagerly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the model for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – String (name of optimizer) or optimizer instance.
See <cite>tf.keras.optimizers</cite>.</p></li>
<li><p><strong>loss</strong> – String (name of objective function), objective function or
<cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>.
An objective function is any callable with the signature
<cite>loss = fn(y_true, y_pred)</cite>, where
y_true = ground truth values with shape = <cite>[batch_size, d0, .. dN]</cite>,
except sparse loss functions such as sparse categorical crossentropy
where shape = <cite>[batch_size, d0, .. dN-1]</cite>.
y_pred = predicted values with shape = <cite>[batch_size, d0, .. dN]</cite>.
It returns a weighted loss float tensor.
If a custom <cite>Loss</cite> instance is used and reduction is set to NONE,
return value has the shape [batch_size, d0, .. dN-1] ie. per-sample
or per-timestep loss values; otherwise, it is a scalar.
If the model has multiple outputs, you can use a different loss on
each output by passing a dictionary or a list of losses. The loss
value that will be minimized by the model will then be the sum of
all individual losses.</p></li>
<li><p><strong>metrics</strong> – List of metrics to be evaluated by the model during training
and testing.
Each of this can be a string (name of a built-in function), function
or a <cite>tf.keras.metrics.Metric</cite> instance. See <cite>tf.keras.metrics</cite>.
Typically you will use <cite>metrics=[‘accuracy’]</cite>. A function is any
callable with the signature <cite>result = fn(y_true, y_pred)</cite>.
To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’: ‘accuracy’, ‘output_b’: [‘accuracy’, ‘mse’]}</cite>.
You can also pass a list (len = len(outputs)) of lists of metrics
such as <cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite> or
<cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>.
When you pass the strings ‘accuracy’ or ‘acc’, we convert this to
one of <cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the loss
function used and the model output shape. We do a similar conversion
for the strings ‘crossentropy’ and ‘ce’ as well.</p></li>
<li><p><strong>loss_weights</strong> – Optional list or dictionary specifying scalar
coefficients (Python floats) to weight the loss contributions
of different model outputs.
The loss value that will be minimized by the model
will then be the <em>weighted sum</em> of all individual losses,
weighted by the <cite>loss_weights</cite> coefficients.
If a list, it is expected to have a 1:1 mapping
to the model’s outputs. If a dict, it is expected to map
output names (strings) to scalar coefficients.</p></li>
<li><p><strong>sample_weight_mode</strong> – If you need to do timestep-wise
sample weighting (2D weights), set this to <cite>“temporal”</cite>.
<cite>None</cite> defaults to sample-wise weights (1D).
If the model has multiple outputs, you can use a different
<cite>sample_weight_mode</cite> on each output by passing a
dictionary or a list of modes.</p></li>
<li><p><strong>weighted_metrics</strong> – List of metrics to be evaluated and weighted
by sample_weight or class_weight during training and testing.</p></li>
<li><p><strong>**kwargs</strong> – Any additional arguments. For eager execution, pass
<cite>run_eagerly=True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – In case of invalid arguments for
    <cite>optimizer</cite>, <cite>loss</cite>, <cite>metrics</cite> or <cite>sample_weight_mode</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">cross_entropy</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.losses.BinaryCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.cross_entropy_metric">
<span class="sig-name descname"><span class="pre">cross_entropy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.BinaryCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.cross_entropy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.load">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved instance of this class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_dir</strong> (<em>str</em>) – Target input folder</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Loaded model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SAAE</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.metrics">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Performance metrics to report at training time</p>
<p>Returns: A list of metric objects</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">mse_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.MeanSquaredError</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates output predictions for the input samples.</p>
<p>Computation is done in batches. This method is designed for performance in
large scale inputs. For small amount of inputs that fit in one batch,
directly using <cite>__call__</cite> is recommended for faster execution, e.g.,
<cite>model(x)</cite>, or <cite>model(x, training=False)</cite> if you have layers such as
<cite>tf.keras.layers.BatchNormalization</cite> that behaves differently during
inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <p>Input samples. It could be:
- A Numpy array (or array-like), or a list of arrays</p>
<blockquote>
<div><p>(in case the model has multiple inputs).</p>
</div></blockquote>
<ul>
<li><p>A TensorFlow tensor, or a list of tensors
(in case the model has multiple inputs).</p></li>
<li><p>A <cite>tf.data</cite> dataset.</p></li>
<li><p>A generator or <cite>keras.utils.Sequence</cite> instance.</p></li>
</ul>
<p>A more detailed description of unpacking behavior for iterator types
(Dataset, generator, Sequence) is given in the <cite>Unpacking behavior
for iterator-like inputs</cite> section of <cite>Model.fit</cite>.</p>
</p></li>
<li><p><strong>batch_size</strong> – Integer or <cite>None</cite>.
Number of samples per batch.
If unspecified, <cite>batch_size</cite> will default to 32.
Do not specify the <cite>batch_size</cite> if your data is in the
form of dataset, generators, or <cite>keras.utils.Sequence</cite> instances
(since they generate batches).</p></li>
<li><p><strong>verbose</strong> – Verbosity mode, 0 or 1.</p></li>
<li><p><strong>steps</strong> – Total number of steps (batches of samples)
before declaring the prediction round finished.
Ignored with the default value of <cite>None</cite>. If x is a <cite>tf.data</cite>
dataset and <cite>steps</cite> is None, <cite>predict</cite> will
run until the input dataset is exhausted.</p></li>
<li><p><strong>callbacks</strong> – List of <cite>keras.callbacks.Callback</cite> instances.
List of callbacks to apply during prediction.
See [callbacks](/api_docs/python/tf/keras/callbacks).</p></li>
<li><p><strong>max_queue_size</strong> – Integer. Used for generator or <cite>keras.utils.Sequence</cite>
input only. Maximum size for the generator queue.
If unspecified, <cite>max_queue_size</cite> will default to 10.</p></li>
<li><p><strong>workers</strong> – Integer. Used for generator or <cite>keras.utils.Sequence</cite> input
only. Maximum number of processes to spin up when using
process-based threading. If unspecified, <cite>workers</cite> will default
to 1. If 0, will execute the generator on the main thread.</p></li>
<li><p><strong>use_multiprocessing</strong> – Boolean. Used for generator or
<cite>keras.utils.Sequence</cite> input only. If <cite>True</cite>, use process-based
threading. If unspecified, <cite>use_multiprocessing</cite> will default to
<cite>False</cite>. Note that because this implementation relies on
multiprocessing, you should not pass non-picklable arguments to
the generator as they can’t be passed easily to children processes.</p></li>
</ul>
</dd>
</dl>
<p>See the discussion of <cite>Unpacking behavior for iterator-like inputs</cite> for
<cite>Model.fit</cite>. Note that Model.predict uses the same interpretation rules as
<cite>Model.fit</cite> and <cite>Model.evaluate</cite>, so inputs must be unambiguous for all
three methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Numpy array(s) of predictions.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – In case of mismatch between the provided
    input data and the model’s expectations,
    or in case a stateful model receives a number of samples
    that is not a multiple of the batch size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.prior_accuracy_metric">
<span class="sig-name descname"><span class="pre">prior_accuracy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.Accuracy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.prior_accuracy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.prior_discriminator_loss">
<span class="sig-name descname"><span class="pre">prior_discriminator_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fake</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.prior_discriminator_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to an output folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_dir</strong> (<em>str</em>) – Target output folder</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.CharStyleSAAE.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.CharStyleSAAE.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The logic for one training step.</p>
<p>This method can be overridden to support custom training logic.
This method is called by <cite>Model.make_train_function</cite>.</p>
<p>This method should contain the mathemetical logic for one step of training.
This typically includes the forward pass, loss calculation, backpropagation,
and metric updates.</p>
<p>Configuration details for <em>how</em> this logic is run (e.g. <cite>tf.function</cite> and
<cite>tf.distribute.Strategy</cite> settings), should be left to
<cite>Model.make_train_function</cite>, which can also be overridden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – A nested structure of <a href="#id2"><span class="problematic" id="id3">`</span></a>Tensor`s.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <cite>dict</cite> containing values that will be passed to
<cite>tf.keras.callbacks.CallbackList.on_train_batch_end</cite>. Typically, the
values of the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PureCharStyleSAAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.engine.training.Model</span></code></p>
<p>This model is trained as a regular SAAE but an additional prior distribution_discriminator model is added to ensure the embedding does not retain information about the character class; i.e. it only retains style information</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.char_accuracy_metric">
<span class="sig-name descname"><span class="pre">char_accuracy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.Accuracy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.char_accuracy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rmsprop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_eagerly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the model for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – String (name of optimizer) or optimizer instance.
See <cite>tf.keras.optimizers</cite>.</p></li>
<li><p><strong>loss</strong> – String (name of objective function), objective function or
<cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>.
An objective function is any callable with the signature
<cite>loss = fn(y_true, y_pred)</cite>, where
y_true = ground truth values with shape = <cite>[batch_size, d0, .. dN]</cite>,
except sparse loss functions such as sparse categorical crossentropy
where shape = <cite>[batch_size, d0, .. dN-1]</cite>.
y_pred = predicted values with shape = <cite>[batch_size, d0, .. dN]</cite>.
It returns a weighted loss float tensor.
If a custom <cite>Loss</cite> instance is used and reduction is set to NONE,
return value has the shape [batch_size, d0, .. dN-1] ie. per-sample
or per-timestep loss values; otherwise, it is a scalar.
If the model has multiple outputs, you can use a different loss on
each output by passing a dictionary or a list of losses. The loss
value that will be minimized by the model will then be the sum of
all individual losses.</p></li>
<li><p><strong>metrics</strong> – List of metrics to be evaluated by the model during training
and testing.
Each of this can be a string (name of a built-in function), function
or a <cite>tf.keras.metrics.Metric</cite> instance. See <cite>tf.keras.metrics</cite>.
Typically you will use <cite>metrics=[‘accuracy’]</cite>. A function is any
callable with the signature <cite>result = fn(y_true, y_pred)</cite>.
To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’: ‘accuracy’, ‘output_b’: [‘accuracy’, ‘mse’]}</cite>.
You can also pass a list (len = len(outputs)) of lists of metrics
such as <cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite> or
<cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>.
When you pass the strings ‘accuracy’ or ‘acc’, we convert this to
one of <cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the loss
function used and the model output shape. We do a similar conversion
for the strings ‘crossentropy’ and ‘ce’ as well.</p></li>
<li><p><strong>loss_weights</strong> – Optional list or dictionary specifying scalar
coefficients (Python floats) to weight the loss contributions
of different model outputs.
The loss value that will be minimized by the model
will then be the <em>weighted sum</em> of all individual losses,
weighted by the <cite>loss_weights</cite> coefficients.
If a list, it is expected to have a 1:1 mapping
to the model’s outputs. If a dict, it is expected to map
output names (strings) to scalar coefficients.</p></li>
<li><p><strong>sample_weight_mode</strong> – If you need to do timestep-wise
sample weighting (2D weights), set this to <cite>“temporal”</cite>.
<cite>None</cite> defaults to sample-wise weights (1D).
If the model has multiple outputs, you can use a different
<cite>sample_weight_mode</cite> on each output by passing a
dictionary or a list of modes.</p></li>
<li><p><strong>weighted_metrics</strong> – List of metrics to be evaluated and weighted
by sample_weight or class_weight during training and testing.</p></li>
<li><p><strong>**kwargs</strong> – Any additional arguments. For eager execution, pass
<cite>run_eagerly=True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – In case of invalid arguments for
    <cite>optimizer</cite>, <cite>loss</cite>, <cite>metrics</cite> or <cite>sample_weight_mode</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.cross_entropy">
<span class="sig-name descname"><span class="pre">cross_entropy</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.losses.BinaryCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.cross_entropy_metric">
<span class="sig-name descname"><span class="pre">cross_entropy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.BinaryCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.cross_entropy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.load">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved instance of this class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_dir</strong> (<em>str</em>) – Target input folder</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Loaded model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SAAE</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.mean_metric">
<span class="sig-name descname"><span class="pre">mean_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.Mean</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.mean_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.mse_metric">
<span class="sig-name descname"><span class="pre">mse_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.MeanSquaredError</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.mse_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.prior_accuracy_metric">
<span class="sig-name descname"><span class="pre">prior_accuracy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.Accuracy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.prior_accuracy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.prior_discriminator_loss">
<span class="sig-name descname"><span class="pre">prior_discriminator_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fake</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.prior_discriminator_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to an output folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_dir</strong> (<em>str</em>) – Target output folder</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.style_loss">
<span class="sig-name descname"><span class="pre">style_loss</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.losses.CategoricalCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.style_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureCharStyleSAAE.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureCharStyleSAAE.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The logic for one training step.</p>
<p>This method can be overridden to support custom training logic.
This method is called by <cite>Model.make_train_function</cite>.</p>
<p>This method should contain the mathemetical logic for one step of training.
This typically includes the forward pass, loss calculation, backpropagation,
and metric updates.</p>
<p>Configuration details for <em>how</em> this logic is run (e.g. <cite>tf.function</cite> and
<cite>tf.distribute.Strategy</cite> settings), should be left to
<cite>Model.make_train_function</cite>, which can also be overridden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – A nested structure of <a href="#id4"><span class="problematic" id="id5">`</span></a>Tensor`s.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <cite>dict</cite> containing values that will be passed to
<cite>tf.keras.callbacks.CallbackList.on_train_batch_end</cite>. Typically, the
values of the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">PureFontStyleSAAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tensorflow.python.keras.engine.training.Model</span></code></p>
<p>This model is trained on all characters from one or more font files at a time; the aim is to encode the font’s style as opposed to single characters’ styles, which can happen when training with scrambled characters from different fonts and results in sometimes having different-looking fonts for a given style in latent space. This model splits batches in two, passing half of it through the encoders to compute the font’s style, and trying to reconstruct the other half using the resulting style vector and label data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rmsprop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_eagerly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.compile" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the model for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – String (name of optimizer) or optimizer instance.
See <cite>tf.keras.optimizers</cite>.</p></li>
<li><p><strong>loss</strong> – String (name of objective function), objective function or
<cite>tf.keras.losses.Loss</cite> instance. See <cite>tf.keras.losses</cite>.
An objective function is any callable with the signature
<cite>loss = fn(y_true, y_pred)</cite>, where
y_true = ground truth values with shape = <cite>[batch_size, d0, .. dN]</cite>,
except sparse loss functions such as sparse categorical crossentropy
where shape = <cite>[batch_size, d0, .. dN-1]</cite>.
y_pred = predicted values with shape = <cite>[batch_size, d0, .. dN]</cite>.
It returns a weighted loss float tensor.
If a custom <cite>Loss</cite> instance is used and reduction is set to NONE,
return value has the shape [batch_size, d0, .. dN-1] ie. per-sample
or per-timestep loss values; otherwise, it is a scalar.
If the model has multiple outputs, you can use a different loss on
each output by passing a dictionary or a list of losses. The loss
value that will be minimized by the model will then be the sum of
all individual losses.</p></li>
<li><p><strong>metrics</strong> – List of metrics to be evaluated by the model during training
and testing.
Each of this can be a string (name of a built-in function), function
or a <cite>tf.keras.metrics.Metric</cite> instance. See <cite>tf.keras.metrics</cite>.
Typically you will use <cite>metrics=[‘accuracy’]</cite>. A function is any
callable with the signature <cite>result = fn(y_true, y_pred)</cite>.
To specify different metrics for different outputs of a
multi-output model, you could also pass a dictionary, such as
<cite>metrics={‘output_a’: ‘accuracy’, ‘output_b’: [‘accuracy’, ‘mse’]}</cite>.
You can also pass a list (len = len(outputs)) of lists of metrics
such as <cite>metrics=[[‘accuracy’], [‘accuracy’, ‘mse’]]</cite> or
<cite>metrics=[‘accuracy’, [‘accuracy’, ‘mse’]]</cite>.
When you pass the strings ‘accuracy’ or ‘acc’, we convert this to
one of <cite>tf.keras.metrics.BinaryAccuracy</cite>,
<cite>tf.keras.metrics.CategoricalAccuracy</cite>,
<cite>tf.keras.metrics.SparseCategoricalAccuracy</cite> based on the loss
function used and the model output shape. We do a similar conversion
for the strings ‘crossentropy’ and ‘ce’ as well.</p></li>
<li><p><strong>loss_weights</strong> – Optional list or dictionary specifying scalar
coefficients (Python floats) to weight the loss contributions
of different model outputs.
The loss value that will be minimized by the model
will then be the <em>weighted sum</em> of all individual losses,
weighted by the <cite>loss_weights</cite> coefficients.
If a list, it is expected to have a 1:1 mapping
to the model’s outputs. If a dict, it is expected to map
output names (strings) to scalar coefficients.</p></li>
<li><p><strong>sample_weight_mode</strong> – If you need to do timestep-wise
sample weighting (2D weights), set this to <cite>“temporal”</cite>.
<cite>None</cite> defaults to sample-wise weights (1D).
If the model has multiple outputs, you can use a different
<cite>sample_weight_mode</cite> on each output by passing a
dictionary or a list of modes.</p></li>
<li><p><strong>weighted_metrics</strong> – List of metrics to be evaluated and weighted
by sample_weight or class_weight during training and testing.</p></li>
<li><p><strong>**kwargs</strong> – Any additional arguments. For eager execution, pass
<cite>run_eagerly=True</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – In case of invalid arguments for
    <cite>optimizer</cite>, <cite>loss</cite>, <cite>metrics</cite> or <cite>sample_weight_mode</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.cross_entropy">
<span class="sig-name descname"><span class="pre">cross_entropy</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.losses.BinaryCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.cross_entropy_metric">
<span class="sig-name descname"><span class="pre">cross_entropy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.BinaryCrossentropy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.cross_entropy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.load">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a saved instance of this class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_dir</strong> (<em>str</em>) – Target input folder</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Loaded model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SAAE</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.mse_metric">
<span class="sig-name descname"><span class="pre">mse_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.MeanSquaredError</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.mse_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.prior_accuracy_metric">
<span class="sig-name descname"><span class="pre">prior_accuracy_metric</span></span><em class="property"> <span class="pre">=</span> <span class="pre">&lt;tensorflow.python.keras.metrics.Accuracy</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.prior_accuracy_metric" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.prior_discriminator_loss">
<span class="sig-name descname"><span class="pre">prior_discriminator_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fake</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.prior_discriminator_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model to an output folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output_dir</strong> (<em>str</em>) – Target output folder</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.scramble_font_batches">
<span class="sig-name descname"><span class="pre">scramble_font_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow.python.framework.ops.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tensorflow.python.framework.ops.Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.scramble_font_batches" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a scrambled copy of a minibatch in which individual fonts are randomly shuffled. Returns the original minibatch in addition to the shuffled version.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>tf.Tensor</em>) – Feature tensor</p></li>
<li><p><strong>labels</strong> (<em>tf.Tensor</em>) – Label tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return scrambled and original feature-label pairs, in that order.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>t.Tuple[tf.Tensor, tf.Tensor, tf.Tensor, tf.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fontai.prediction.models.PureFontStyleSAAE.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fontai.prediction.models.PureFontStyleSAAE.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The logic for one training step.</p>
<p>This method can be overridden to support custom training logic.
This method is called by <cite>Model.make_train_function</cite>.</p>
<p>This method should contain the mathemetical logic for one step of training.
This typically includes the forward pass, loss calculation, backpropagation,
and metric updates.</p>
<p>Configuration details for <em>how</em> this logic is run (e.g. <cite>tf.function</cite> and
<cite>tf.distribute.Strategy</cite> settings), should be left to
<cite>Model.make_train_function</cite>, which can also be overridden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – A nested structure of <a href="#id6"><span class="problematic" id="id7">`</span></a>Tensor`s.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <cite>dict</cite> containing values that will be passed to
<cite>tf.keras.callbacks.CallbackList.on_train_batch_end</cite>. Typically, the
values of the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fontai.prediction">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fontai.prediction" title="Permalink to this headline">¶</a></h2>
<p>This submodule contains Tensorflow-related classes that preprocess and format model inputs and define custom Keras models and callbacks. Arbitrary sequential Keras models can be instantiated from configurations, but user-defined custom models can be used as well by defining them in the <cite>models</cite> module.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">textfont-ai</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Nestor Sanchez.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/fontai.prediction.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>